<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>A streamlined data flow for improved decision making: data collection to analysis and all the gunk in between</title>
    <meta charset="utf-8" />
    <meta name="author" content="Ryan N. Kinzer" />
    <link href="index_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="index_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link href="index_files/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
    <script src="index_files/htmlwidgets-1.5.2/htmlwidgets.js"></script>
    <script src="index_files/jquery-1.12.4/jquery.min.js"></script>
    <link href="index_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="index_files/datatables-binding-0.16/datatables.js"></script>
    <link href="index_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="index_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="index_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
    <link href="index_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
    <script src="index_files/nouislider-7.0.10/jquery.nouislider.min.js"></script>
    <link href="index_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
    <script src="index_files/selectize-0.12.0/selectize.min.js"></script>
    <link href="index_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
    <script src="index_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="css/my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">



class: title-slide

&lt;div id="titlebox"&gt;
  &lt;hr style="height:2px;border-width:0;color:#000063;background-color:#000063"&gt;
  &lt;hr style="height:2px;border-width:0;color:#000063;background-color:#000063"&gt;
  &lt;p&gt;.bold[Streamlined data flow for improved decision making:]&lt;/p&gt;
&lt;/div&gt;

&lt;div id="authorbox"&gt;

&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"&gt;

  Ryan N. Kinzer
    &lt;a href="mailto: ryank@nezperce.org" class="fa fa-paper-plane"&gt;&lt;/a&gt;
    &lt;a href="http://github.com/ryankinzer" class="fa fa-github"&gt;&lt;/a&gt;
    &lt;a href="http://twitter.com/kinzer_ryan" class="fa fa-twitter"&gt;&lt;/a&gt;
  &lt;br/&gt;
  Nez Perce Tribe &lt;br/&gt;
  Department of Fisheries Resources Management &lt;br/&gt;
  Research Division &lt;a href="https://nptfisheries.shinyapps.io/kus-data/" class="fa fa-link"&gt;&lt;/a&gt;
  &lt;br/&gt;
&lt;/div&gt;  

???
Thank you for joining us today.  I'm sure you are hear to see Dan's talk and were just unlucky to show up early.  

---
class: middle
background-image: url("figures/wang.gif")
background-position: top 50% right 55px
background-size: 40%

.pull-left[
...from data collection to reporting and all the gunk in between.
&lt;!--&lt;p style="font-size:25px"&gt;...from data collection to reporting and all the gunk in between.&lt;/p&gt;--&gt;
]

???

focusing on the flow of data. when you have it.

---
class: mainslide
layout: true
---
class: center, middle

background-color: black
background-image: url("figures/problem.png")
background-position: top 0px left 0px
background-size: 100%


.white[

"Bad data for half the price of good data is a fool's investment." - Clark and Whitfield 1993

"science is presently hindered by the '80:20 problem'...." – Michener 2012

"More often than scientists would like to admit, they cannot even recover the data associated with their own published works." – Goodman et al. 2014

"This fundamental shift in thinking from 'I own the data' to 'I collect and share the data' .... is essential to the transparency and reproducibility of the open science framework." – Hampton et al. 2015
]

???
These four quotes really resonated with me when I read them for the first time a few years ago, and how they pertained to my experiences working with various fish biologists over the years.  I won't read them exactly, but they will give you the reasons I'm moving forward in the way that I am, and that we will discuss today.

---
background-image: url('figures/NPTlogos2.png')
background-position: top 5% right 5%
background-size: 10%

# Goals for Today
* Highlight a few data management and analysis problems that we have faced.
* Illustrate one way to tackle the issues.
* Get you thinking about your data flow and ways to improve.

.center[
&lt;img class = "displayed" src = 'figures/data-is-the-new-oil-toxic-if-mishandled.jpg' width = 75%/&gt;
]

???

---
class: inverse, middle, center

## Generate discussion and learn from each other.

???

And then selfishly, I want to generate discussion, learn from each other, and hopefully I discover from all of you how I can do things better. 

---
class: inverse, center, middle

## MentiMeter Poll
### Which piece of the data flow process is the most problematic for you?

.pull-left[
* .yellow[Querying and Accessing]
* Preserving and Protecting
* Summarizing and Analyzing
* Timely Reporting
* Sharing and Publishing Results
]

.pull-right[
    &lt;img src = 'figures/You-want-my-metadata-608.png' width = 100%/&gt;
]

???
* Columbia River basin and PIT-tag data, or CWT data stored in the RMIS database, genetics data--often requires intimate knowledge of data repository and queries to get the right information you are looking for.

---
class: inverse, center, middle

## MentiMeter Poll
### Which piece of the data flow process is the most problematic for you?

.pull-left[
* Querying and Accessing
* .yellow[Preserving and Protecting]
* Summarizing and Analyzing
* Timely Reporting
* Sharing and Publishing Results
]

.pull-right[
    &lt;img src = 'figures/RME_2020_spending.png' width = 100%/&gt;
]

???
* In 2020, Bonneville Power Administration spent over 100 million on RME, and over half of that was spent on data collection.
---
class: inverse, center, middle

## MentiMeter Poll
### Which piece of the data flow process is the most problematic for you?

.pull-left[
* Querying and Accessing
* Preserving and Protecting
* .yellow[Summarizing and Analyzing]
* Timely Reporting
* Sharing and Publishing Results
]

.pull-right[
    &lt;img src = 'figures/we-waste-2-million-arguing-redo.jpg' width = 100%/&gt;
]

???
Big data....PTAGIS data base contains over 

---
class: inverse, center, middle

## MentiMeter Poll
### Which piece of the data flow process is the most problematic for you?

.pull-left[
* Querying and Accessing
* Preserving and Protecting
* Summarizing and Analyzing
* .yellow[Timely Reporting]
* Sharing and Publishing Results
]

.pull-right[
&lt;img src = 'figures/data_reporting.jpg' width = 100%/&gt;
]

???
Returning back to the 80:20 problem I mentioned earlier, do you have enought time to adequatly focus on analysis and reporting?; 

---
class: inverse, center, middle

## MentiMeter Poll
### Which piece of the data flow process is the most problematic for you?

.pull-left[
* Querying and Accessing
* Preserving and Protecting
* Summarizing and Analyzing
* Timely Reporting
* .yellow[Sharing and Publishing Results]
]

.pull-right[
    &lt;img src = 'figures/i-have-data_3.jpg' width = 100%/&gt;
]

&lt;a href="https://www.menti.com/eirgddtvad"&gt;https://www.menti.com/eirgddtvad&lt;/a&gt;

???
What about getting your results noticed and used, to support informed decision making? Do the decision makers actually look at and use your reports and findings?

---

&lt;div style='position: relative; padding-bottom: 56.25%; padding-top: 35px; height: 0; overflow: hidden;'&gt;&lt;iframe sandbox='allow-scripts allow-same-origin allow-presentation' allowfullscreen='true' allowtransparency='true' frameborder='0' height='315' src='https://www.mentimeter.com/embed/c1b1cea343c68eaa661412bde8e8cedf/b0e1bf101754' style='position: absolute; top: 0; left: 0; width: 100%; height: 100%;' width='420'&gt;&lt;/iframe&gt;&lt;/div&gt;

---
background-image: url('figures/NPTlogos2.png')
background-position: top 5% right 5%
background-size: 10%

# Presentation Outline
* DFRM Research Division and RME Background
* Data Management and Analysis Problems
* Data Strategy and Vision
* Example: Natural-origin Spawner Abundance

.center[
&lt;img src="figures/stopconfusingmewithfacts.jpg"/&gt;
]

???

The big deal is not just having the data, but being able to quickly and efficiently access needed data.
Ensure high quality results

Data Management Maturity Model

What is the Data Science Process
  
---
class: middle
background-image: url('figures/NPTlogos2.png')
background-position: top 5% right 5%
background-size: 10%

### DFRM RME Background

.left-column[
**Four Office Locations**
* Sweetwater
* Orofino
* McCall
* Joseph

**Nine RME Projects**
* Hatchery Program Evaluations
* Status and Trends Monitoring

**Independently Focused**
]

.right-column[
&lt;iframe  title="My Map" width="1800" height="500" src="figures/npt_locations.html" frameborder="2" allowfullscreen&gt;&lt;/iframe&gt;
]

???

Work almost exclusively in the Snake River Basin.

DFRM Research Division Background
M&amp;E for Hatchery Program Evaluations
Filled M&amp;E Gaps for Key Populations

  * Office: Sweetwater, Orofino, Joseph, McCall

  * Hatchery Program Evaluations
    NPTH Fall
    NPTH Spring
    SRBA
    JCAPE
    GRSME
  * Status and Trends Monitoring
    IPTDS
    ISAM
    Bulltrout
  * Data Management

---
class: inverse, middle, center
# Problems

---
class: middle
background-image: url("figures/spreadsheet.gif")
background-position: top 50% left 50%
background-size: 50%

???
# Problems we faced
* Collecting and Accessing
  - Consistency
  - Efficiencies and versioning problems
* Preserving and Protecting
  - Hard Copies
  - Outdated file formats
  - Personnel Changes
* Summarizing and Analyzing
  - Lack of expertise/training
  - Consistency
  - Reproducibility
  - Spreadsheets
* Timely Reporting and Publishing
  - Not enough time.
* Sharing Results
  - Detailed Annual Reports

---
class: middle
background-image: url("figures/Apple-Orange.jpg")
background-position: top 50% left 50%
background-size: 100%

???
Coordinated Assessments - Regional Databases
How is this data being rolled up across the landscape and being used to inform decisions?
We saw this as a potential problem, and if we were facing it withing our own division, it would only get larger as you went across agencies and basins.

---
class: middle
background-image: url("figures/drives.png")
background-position: top 50% left 50%
background-size: 75%

---
class: middle
background-image: url("figures/crossed-fingers.png")
background-position: top 50% left 50%
background-size: 75%
---
class: inverse, middle, center

# What did we do?

---
class: inverse, left, middle
# Data Strategy and Vision

&lt;img src="figures/data_man_vision.png"/&gt;

???
Dreamt up a simple solution based on these four boxes.

---

class: inverse, left, top
## Consistency and Standard Methods

.pull-left[
Data Collection
&lt;img src="figures/protocols.png" width = 400px; height = 450px/&gt;
]

.pull-right[
Summaries and Analysis
&lt;img src="figures/methods.png" width = 400px; height = 450px/&gt;
]

???
Introduce idea of tech teams
---
class: inverse, right, middle

# Current Data Architecture

&lt;img src="figures/data_flow.png"/&gt;

???

Stacy Schumacher (CTUIR) Feb. 11th will focus on CDMS- so I encourage you to watch Stacy's talk if you are interested in the details of the database and how it functions. 

# Current Staffing/Product Structure

can we show tech teams and contributions?
what about monitoring strategy?

# Available Datasetsp

# Data Maturity Model


## All sounds great...but what are the problems now?

---
class: inverse, middle, center

# Example

???
Sp/Sm Chinook Salmon Female Proportion &lt;br/&gt; 
Spring/summer Chinook Salmon Escapement &lt;br/&gt;
Steelhead Juvenile Survival &lt;br/&gt;

---
class: center, middle

### Sp/sm Chinook Salmon - Natural-origin Spawner Abundance

`$$\hat{NOSA} = \hat{N}*(1-\hat{pHOS})*(1-\hat{pPSM}_{N})$$`

.pull-left[

.bold[Above Weir Escapement]
`$$\hat{N} = (\frac{(n_1+1)*(n_2+1)}{(m_2+1)}) - 1$$`
.bold[Proportion of Hatchery Origin Spawners]
`$$\hat{pHOS} = \frac{n_H}{(n_H + n_N)}$$`

.bold[Pre-spawn Mortality]
`$$\hat{pPSM}_{N} = \frac{n_{p,N}}{(n_{p,N} + n_{s,N})}$$`

]

.pull-right[
&lt;img src = "figures/Lostine Weir2.jpg"/&gt;
&lt;img src = "figures/carcass.png"/&gt;
]

???
#### Adult Weir Data
`\(n_1 =\)` Marks Released &lt;br/&gt;

#### Spawning Ground Survey Data
`\(n_2 =\)` Total Carcasses Collected &lt;br/&gt;
`\(m_2 =\)` Recaptured Carcasses &lt;br/&gt;
`\(n_H =\)`  Hatchery-origin Carcasses&lt;br/&gt;
`\(n_N =\)`  Natural-origin Carcasses&lt;br/&gt;
`\(n_{p} =\)`  Pre-spawned Carcasses&lt;br/&gt;
`\(n_{s} =\)`  Spawned Carcasses&lt;br/&gt;

---

## Data Collection

.pull-left[
.center[
#### Spawning Ground Surveys
&lt;img src = "figures/maxresdefault.jpg" width = 70%/&gt;
]
]

.pull-right[
.center[
#### Adult Weir Operations
&lt;img src = "figures/fins_logo.jpg" width = 60%/&gt;
]
]

.center[
#### Centralized Data Management System
&lt;img src = "figures/cdms.png" width = 60%/&gt;
]

???
*collection is electronic but offline due to our monitoring locations
*so not exactly real-time....but close

ETIS - Samantha Smith: Jan. 7th, 2021, Latest applications for handheld devices for field data collection 

---

## Data Access



.pull-left[
&lt;br/&gt;


```r
library(tidyverse)
library(cdmsR)
cdmsLogin(username, password)
```


```r
# Check for available datasets
glimpse(getDatastores())
```
]

.pull-right[
.center[
&lt;img src='figures/cdmsR_hex.png' width = 50%/&gt;
]
]

.scroll-x[

```
## Rows: 26
## Columns: 8
## $ Id             &lt;int&gt; 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, ...
## $ Name           &lt;chr&gt; "SGS Redd Data", "SGS Carcass Data", "NPT Summarized...
## $ Description    &lt;chr&gt; "Nez Perce Tribe spawning ground survey redd dataset...
## $ TablePrefix    &lt;chr&gt; "SGS_Redd", "SGS_Carcass", "NPT_Age", "StreamNet_Juv...
## $ LocationTypeId &lt;chr&gt; "1122", "1122", "1134", "1125", "1125", "1125", "112...
## $ DefaultConfig  &lt;chr&gt; "{\r\n\"DataEntryPage\":\r\n\t{\r\n\t\"HiddenFields\...
## $ OwnerUserId    &lt;int&gt; 3156, 3156, 3156, 3156, 3156, 3156, 3156, 3156, 3156...
## $ TableType      &lt;chr&gt; "Header+Detail", "Header+Detail", "Header+Detail", "...
```
]

---

## Data Access

.pull-left[

```r
#car_dat &lt;- getDatasetView(datastoreID = 79)
#save(car_dat, file = './data/car_dat.rda')
load('./data/car_dat.rda')
```


```r
library(cuyem)
# Basic QA/QC and create valued-added fields
cleaned_car &lt;- clean_carcassData(car_dat)
```

.center[
&lt;img src = "figures/cdmsR_cuyem_hex.png" width = 70%/&gt;
]
]

.pull-right[
.scroll-box-24[

```
## Rows: 32,304
## Columns: 82
## $ ESU_DPS              &lt;chr&gt; "Snake River Fall-run Chinook Salmon ESU", "Sn...
## $ MPG                  &lt;chr&gt; "Snake River", "Snake River", "Snake River", "...
## $ POP_NAME             &lt;chr&gt; "Snake River Lower Mainstem", "Snake River Low...
## $ TRT_POPID            &lt;chr&gt; "SNLMA-f", "SNLMA-f", "SNLMA-f", "SNLMA-f", "S...
## $ Species              &lt;chr&gt; "Chinook salmon", "Chinook salmon", "Chinook s...
## $ Run                  &lt;chr&gt; "Fall", "Fall", "Fall", "Fall", "Fall", "Fall"...
## $ ReportingGroup       &lt;chr&gt; "Clearwater River", "Clearwater River", "Clear...
## $ StreamName           &lt;chr&gt; "Clearwater River", "Clearwater River", "Clear...
## $ TribToName           &lt;chr&gt; "Snake River", "Snake River", "Snake River", "...
## $ LocationLabel        &lt;chr&gt; "Clearwater River: Transect - Lower Clearwater...
## $ TransectName         &lt;chr&gt; "Lower Clearwater River", "Lower Clearwater Ri...
## $ SurveyYear           &lt;dbl&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013...
## $ SurveyDate           &lt;date&gt; 2013-11-20, 2013-11-20, 2013-11-20, 2013-11-2...
## $ ActivityDate         &lt;chr&gt; "2013-11-20T00:00:00", "2013-11-20T00:00:00", ...
## $ ActivityId           &lt;int&gt; 35108, 35108, 35108, 35108, 35108, 35108, 3510...
## $ DatasetId            &lt;int&gt; 4325, 4325, 4325, 4325, 4325, 4325, 4325, 4325...
## $ LocationId           &lt;int&gt; 612, 612, 612, 612, 612, 612, 612, 612, 612, 6...
## $ TargetSpecies        &lt;chr&gt; "F_CHN", "F_CHN", "F_CHN", "F_CHN", "F_CHN", "...
## $ Pass                 &lt;int&gt; -99, -99, -99, -99, -99, -99, -99, -99, -99, -...
## $ StartSurvey          &lt;chr&gt; "RKm 6.4", "RKm 6.4", "RKm 6.4", "RKm 6.4", "R...
## $ EndSurvey            &lt;chr&gt; "RKm 70.6", "RKm 70.6", "RKm 70.6", "RKm 70.6"...
## $ StartTime            &lt;chr&gt; "00:00:00", "00:00:00", "00:00:00", "00:00:00"...
## $ EndTime              &lt;chr&gt; "00:00:00", "00:00:00", "00:00:00", "00:00:00"...
## $ Observers            &lt;chr&gt; "BA", "BA", "BA", "BA", "BA", "BA", "BA", "BA"...
## $ SurveyMethod         &lt;chr&gt; "Boat", "Boat", "Boat", "Boat", "Boat", "Boat"...
## $ GPSUnit              &lt;chr&gt; "NC", "NC", "NC", "NC", "NC", "NC", "NC", "NC"...
## $ Datum                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Weather              &lt;chr&gt; "NC", "NC", "NC", "NC", "NC", "NC", "NC", "NC"...
## $ Visibility           &lt;chr&gt; "NC", "NC", "NC", "NC", "NC", "NC", "NC", "NC"...
## $ SurveyComments       &lt;chr&gt; "Location=Clearwater River", "Location=Clearwa...
## $ SampleNumber         &lt;chr&gt; "0249", "0250", "0251", "0252", "0253", "0254"...
## $ HistoricSampleNumber &lt;chr&gt; "13-249", "13-250", "13-251", "13-252", "13-25...
## $ CarcassSpecies       &lt;chr&gt; "F_CHN", "F_CHN", "F_CHN", "F_CHN", "F_CHN", "...
## $ Sex                  &lt;chr&gt; "Male", "Male", "Male", "Female", "Female", "F...
## $ ForkLength           &lt;int&gt; 600, 620, 660, 700, 810, 870, 530, 790, 600, 6...
## $ SpawnedOut           &lt;chr&gt; "Unknown", "Unknown", "Unknown", "Yes", "Yes",...
## $ PercentSpawned       &lt;int&gt; -99, -99, -99, 100, 100, 100, -99, 100, -99, -...
## $ OpercleLeft          &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No"...
## $ OpercleRight         &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No"...
## $ PITScanned           &lt;chr&gt; "Yes", "Yes", "Yes", "No", "No", "No", "No", "...
## $ PITCode              &lt;chr&gt; "3D9.1C2D9AE593", "3D9.1C2DA7BCDD", "3D9.1C2DA...
## $ AdiposeFinClipped    &lt;chr&gt; "No", "No", "No", "Yes", "Yes", "Yes", "No", "...
## $ CWTScanned           &lt;chr&gt; "No", "Yes", "No", "Yes", "Yes", "No", "Yes", ...
## $ SnoutCollected       &lt;chr&gt; "No", "Yes", "No", "Yes", "Yes", "No", "Yes", ...
## $ Fins                 &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No"...
## $ Scales               &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes...
## $ Otolith              &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No"...
## $ Count                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ CarcassComments      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Latitude             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Longitude            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ RadioTag             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ TransmitterType      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Vendor               &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SerialNumber         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Frequency            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Channel              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Code                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ TagsFloy             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ TagsVIE              &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No"...
## $ TagsJaw              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ TagsStaple           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ TagsSpaghetti        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ MarksVentralFin      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Notes                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ QAStatusId           &lt;int&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...
## $ CWTCode              &lt;chr&gt; "NA", "220205", "NA", "635997", "220200", "NA"...
## $ TagsPetersonDisk     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ CarcassWPT           &lt;chr&gt; "NA", "NA", "NA", "NA", "NA", "NA", "NA", "NA"...
## $ DNACollected         &lt;chr&gt; "No", "No", "No", "No", "Yes", "No", "Yes", "Y...
## $ ActivityQAStatusId   &lt;int&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...
## $ ActivityQAComments   &lt;chr&gt; "Bulk import from sgs_master by RK", "Bulk imp...
## $ FieldsheetLink       &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ QAStatusName         &lt;chr&gt; "Ready for QA", "Ready for QA", "Ready for QA"...
## $ EffDt                &lt;chr&gt; "2018-12-07T14:30:51.03", "2018-12-07T14:30:51...
## $ Year                 &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013...
## $ AboveWeir            &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes...
## $ AbovePITArray        &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes...
## $ AboveRST             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Origin               &lt;chr&gt; "Natural", "Hatchery", "Natural", "Hatchery", ...
## $ Mark_Discernible     &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE...
## $ Recapture            &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
```
]
]

---
## Weir Data Access: fisheR

.pull-left[


```r
library(fisheR)
```


```r
# trap_dat &lt;- get_FINSdata(
#   module = 'Trapping',
#   scope = 'NPT',
#   startDate = '01/01/1990',
#   endDate = '12/31/2020'
# )

#save(trap_dat, file = './data/trap_dat.rda')
load('./data/trap_dat.rda')
cleaned_trap &lt;- clean_weirData(trap_dat)
```

.center[
&lt;img src="figures/fins_logo.jpg" width = 49%/&gt;
&lt;img src="figures/fisheR_cuyem_hex.png" width = 49%/&gt;
  ]
]

.pull-right[
.scroll-box-24[

```
## Rows: 72,949
## Columns: 73
## $ trap_year                    &lt;dbl&gt; 1997, 1997, 2008, 2008, 2008, 2008, 20...
## $ trapped_date                 &lt;date&gt; 1997-07-18, 1997-08-06, 2008-08-06, 2...
## $ tmp_fish_id                  &lt;chr&gt; "1", "10", "10000", "10001", "10002", ...
## $ current_location             &lt;chr&gt; NA, "Upstream", "Upstream", "Upstream"...
## $ final_location               &lt;chr&gt; NA, "Upstream", "Upstream", "Upstream"...
## $ finalize                     &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
## $ verify                       &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
## $ `follow-up`                  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
## $ is_import                    &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TR...
## $ facility                     &lt;chr&gt; "NPT GRSME Program", "NPT GRSME Progra...
## $ trap                         &lt;chr&gt; "Lostine River Weir", "Lostine River W...
## $ trap_is_offsite              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
## $ trapping_session_name        &lt;chr&gt; "Session - 07/18/1997 Lostine River We...
## $ target_species               &lt;chr&gt; "Chinook", "Chinook", "Chinook", "Chin...
## $ target_run                   &lt;chr&gt; "Summer", "Summer", "Summer", "Summer"...
## $ trapping_session_comments    &lt;chr&gt; NA, NA, "TENDER(S): CARL EAST", "TENDE...
## $ fish_id                      &lt;dbl&gt; NA, NA, 7, 6, 4, 1, 8, 3, 5, 14, 2, 3,...
## $ count                        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ species                      &lt;chr&gt; "Chinook", "Chinook", "Chinook", "Mtn ...
## $ run                          &lt;chr&gt; "Summer", "Summer", "Summer", NA, NA, ...
## $ sex                          &lt;chr&gt; "Female", "Female", "Male", "Unknown",...
## $ origin                       &lt;chr&gt; "Natural", "Natural", "Hatchery-Supple...
## $ origin_expression            &lt;chr&gt; "Existing Unclipped [Mark UNC]  and Ex...
## $ origin_description           &lt;chr&gt; "Natural", "Natural", "Johnson Creek S...
## $ origin_creator               &lt;chr&gt; "Default", "Default", "dougn", "dougn"...
## $ origin_creation_date         &lt;chr&gt; "5/17/2017", "5/17/2017", "3/8/2018", ...
## $ living_status                &lt;chr&gt; "Alive", "Alive", "Alive", "Alive", "A...
## $ length                       &lt;dbl&gt; 808, 745, 800, 360, 350, 620, 590, 340...
## $ age_designation              &lt;chr&gt; NA, NA, "Adult", NA, NA, "Jack/Jill", ...
## $ age_calculated               &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, FALSE, TRUE...
## $ age_criteria_start_length    &lt;dbl&gt; NA, NA, 670, NA, NA, 300, 300, NA, 670...
## $ age_criteria_end_length      &lt;dbl&gt; NA, NA, 1500, NA, NA, 669, 669, NA, 15...
## $ age_criteria_start_date      &lt;chr&gt; NA, NA, "1/1/2008", NA, NA, "1/1/2008"...
## $ age_criteria_end_date        &lt;chr&gt; NA, NA, "12/31/2008", NA, NA, "12/31/2...
## $ moved_to_facility            &lt;chr&gt; "NPT GRSME Program", "NPT GRSME Progra...
## $ moved_to                     &lt;chr&gt; "Lookingglass Fish Hatchery", "Lostine...
## $ moved_to_location_type       &lt;chr&gt; "Holding", "Release Site", "Release Si...
## $ moved_to_is_offsite          &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
## $ offsite_owner_facility       &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ offsite_location_latitude    &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ offsite_location_longitude   &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ offsite_location_description &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ disposition                  &lt;chr&gt; "Ponded", "Released", "Released", "Rel...
## $ release_site                 &lt;chr&gt; NA, "Lostine River: Above Weir", "John...
## $ release_site_latitude        &lt;dbl&gt; NA, 45.54314, 44.90106, 44.90106, 44.9...
## $ release_site_longitude       &lt;dbl&gt; NA, -117.4842, -115.4889, -115.4889, -...
## $ purpose                      &lt;chr&gt; "Brood Stock", "Natural Spawning", "Na...
## $ existing_marks               &lt;chr&gt; "UNC", "UNC", "UNC", "UNC", "UNC", "UN...
## $ existing_marks_quantity      &lt;chr&gt; "1", "1", "1", "1", "1", "1", "1", "1"...
## $ applied_marks                &lt;chr&gt; NA, NA, "CP", NA, NA, "CP", "CP", NA, ...
## $ applied_marks_quantity       &lt;chr&gt; NA, NA, "1", NA, NA, "1", "1", NA, "1"...
## $ existing_tags                &lt;chr&gt; "None", "None", "None", "None", "None"...
## $ applied_tags                 &lt;chr&gt; NA, NA, "OP RYTT 1109", NA, NA, "OP RY...
## $ existing_cwt                 &lt;chr&gt; "Not Present", "Not Present", "Present...
## $ existing_cwt_value           &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ applied_cwt                  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ applied_cwt_value            &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ existing_pit                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ applied_pit                  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ samples                      &lt;chr&gt; NA, NA, "GEN 1109", NA, NA, "GEN 1107"...
## $ conditions                   &lt;chr&gt; NA, NA, "BI", NA, NA, NA, NA, NA, NA, ...
## $ recap                        &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
## $ injected                     &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, FALSE, FALS...
## $ weight                       &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ notes                        &lt;chr&gt; NA, NA, "GAFF WOUND", NA, NA, NA, NA, ...
## $ group_notes                  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ import_custom                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ weir                         &lt;chr&gt; "Lostine River Weir", "Lostine River W...
## $ stream                       &lt;chr&gt; "Lostine River", "Lostine River", "Joh...
## $ release_up                   &lt;lgl&gt; FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, T...
## $ release_dwn                  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
## $ marked                       &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, FALSE, TRUE...
## $ recapped                     &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
```
]
]

---
background-image: url('figures/dfrm_hex.png')
background-position: top 5% right 5%
background-size: 10%

# Estimate Escapement

```r
MR_ests &lt;- get_MRests(
  cleaned_trap, cleaned_car,
  species = 'Chinook',
  alpha = 0.05)
```

.tiny[
<div id="htmlwidget-6b8cad5a0e1d4400d912" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6b8cad5a0e1d4400d912">{"x":{"filter":"top","filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1998\" data-max=\"2020\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2\" data-max=\"1503\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2\" data-max=\"840\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"836\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2\" data-max=\"1514.6\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"263.73\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-17.08\" data-max=\"1506.91\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2\" data-max=\"1530.26\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85"],[1998,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2002,2003,2004,2005,2006,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,1998,1999,2000,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018],["Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Johnson Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lolo Creek","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Lostine River","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Newsome Creek","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River","Secesh River"],["Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook"],[60,78,1331,1085,692,248,119,113,317,556,697,962,708,649,907,1503,892,624,327,512,180,350,111,23,154,27,11,58,44,23,112,3,41,30,171,14,5,3,20,10,52,700,131,149,935,209,818,504,836,241,517,369,605,219,290,83,24,2,3,47,26,137,107,133,73,52,53,37,13,17,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[68,26,840,611,500,81,78,56,116,333,361,518,319,280,342,652,113,230,71,158,37,107,131,71,101,25,3,53,25,19,134,112,37,60,25,59,73,36,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,48,68,18,9,3,3,11,5,49,61,38,25,36,25,8,2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[38,18,836,602,484,75,78,56,109,329,315,508,261,252,309,647,110,229,70,152,31,105,19,2,42,4,3,17,7,2,45,1,2,3,7,1,2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,44,49,17,6,3,null,6,1,40,43,34,17,29,8,6,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[106.92,111.26,1337.37,1101.21,714.86,267.66,119,113,337.24,562.75,798.61,980.92,864.95,720.94,1003.66,1514.6,916.14,626.72,331.62,532.12,213.94,356.62,738.2,575,366.67,144.6,11,176,145.25,159,330.63,225,531,471.75,558,449,147,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,238.56,400.58,87.67,34.71,2,null,81.29,80,167.29,151.18,148.31,105.89,64.37,155,47.86,null,null,914,334,223,301,901,1139,1155,923,909,889,1467,391,536,479,555],[6.76,11.91,1.94,3.63,3.18,6.9,0,0,6.35,2.16,11.84,4.14,18.05,11.17,14.34,3.93,13.16,2.16,4.09,6.99,13.49,3.93,134.67,263.73,35.83,48.42,0,27.64,36.78,68.99,30.24,91.44,246,190.73,151.39,237.8,51.25,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,9,26.85,4.14,5.87,-0,null,17.36,36.74,9.24,9.41,6.85,11.83,3.36,36.41,7.35,null,null,98.71,3.34,7.58,12.04,33.34,78.59,24.25,18.46,24.54,29.34,32.27,28.15,24.66,10.54,13.88],[93.68,87.92,1333.56,1094.1,708.63,254.13,119,113,324.79,558.51,775.39,972.8,829.58,699.03,975.55,1506.91,890.35,622.48,323.6,518.42,187.5,348.92,474.26,58.1,296.44,49.71,11,121.83,73.16,23.78,271.35,45.77,48.85,97.93,261.28,-17.08,46.54,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,220.91,347.95,79.56,23.21,2,null,47.27,7.99,149.19,132.74,134.89,82.7,57.77,83.63,33.44,null,null,720.53,327.45,208.14,277.4,835.66,984.96,1107.46,886.82,860.9,831.5,1403.74,335.82,487.68,458.35,527.81],[120.17,134.6,1341.18,1108.32,721.09,281.19,119,113,349.68,566.99,821.82,989.04,900.33,742.84,1031.76,1522.3,941.92,630.95,339.63,545.82,240.38,364.33,1002.14,1091.9,436.91,239.49,11,230.17,217.34,294.22,389.91,404.23,1013.15,845.57,854.72,915.08,247.46,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,256.2,453.21,95.77,46.22,2,null,115.3,152.01,185.4,169.62,161.74,129.08,70.96,226.37,62.27,null,null,1107.47,340.55,237.86,324.6,966.34,1293.04,1202.54,959.18,957.1,946.5,1530.26,446.18,584.32,499.65,582.19]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trap_year<\/th>\n      <th>stream<\/th>\n      <th>species<\/th>\n      <th>n1<\/th>\n      <th>n2<\/th>\n      <th>m2<\/th>\n      <th>N<\/th>\n      <th>SE<\/th>\n      <th>lwr<\/th>\n      <th>upr<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"columnDefs":[{"className":"dt-right","targets":[1,4,5,6,7,8,9,10]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
]

---
# Proportion of Hatchery Spawners

.left-code[

```r
pHOS &lt;- cleaned_car %&gt;%
  filter(
    CarcassSpecies == 'S_CHN',
    Origin %in% c('Natural', 'Hatchery'),
    AboveWeir == 'Yes'
  ) %&gt;%
  est_group_p(
    .summary_var = Origin,
    alpha = 0.05,
    SurveyYear,
    StreamName
  ) %&gt;%
  rename_with(~paste0('pHOS_',.x), n:upr)
```


.center[
&lt;img src="figures/cdmsR_cuyem_hex.png" width = 49%/&gt;
  ]
]

.right-plot[
&lt;img src="index_files/figure-html/fig_pHOS-1.png" width="504" /&gt;
]

---
# Proportion Pre-spawn Mortality

.left-code[

```r
pPSM &lt;- cleaned_car %&gt;%
  filter(
    CarcassSpecies == 'S_CHN',
    Origin  == 'Natural',
    SpawnedOut %in% c('Yes', 'No'),
    AboveWeir == 'Yes'
  ) %&gt;%
  est_group_p(
    .summary_var = SpawnedOut,
    alpha = 0.05,
    SurveyYear,
    StreamName
  ) %&gt;%
  rename_with(~paste0('pPSM_',.x), n:upr)
```



.center[
&lt;img src="figures/cdmsR_cuyem_hex.png" width = 49%/&gt;
  ]

]

.right-plot[
&lt;img src="index_files/figure-html/fig_psm-1.png" width="504" /&gt;
]

---

# Natural-origin Spawner Abundance

.left-code[

```r
NOSA &lt;- left_join(
  MR_ests %&gt;% rename(SurveyYear = trap_year, StreamName = stream),
  pHOS %&gt;%
    filter(Origin == 'Hatchery'),
  by = c("SurveyYear", "StreamName")
) %&gt;%
  left_join(
    pPSM %&gt;%
      filter(SpawnedOut == 'No'),
    by = c("SurveyYear", "StreamName")
  ) %&gt;%
  mutate(
    NOSA = N * (1-pHOS_p) * (1-pPSM_p)
  )
```



.center[
&lt;img src="figures/analysis_engine_hex.png" width = 49%/&gt;
  ]

]

.right-plot[
&lt;img src="index_files/figure-html/fig_nosa-1.png" width="504" /&gt;
]

---

# Natural-origin Spawner Abundance

.left-code[


```r
#redd_dat &lt;- getDatasetView(datastoreID = 78)
#save(redd_dat, file = './data/redd_dat.rda')
load('./data/redd_dat.rda')
cleaned_redd &lt;- clean_reddData(redd_dat)
```






```r
NOSA_ests &lt;- get_NOSAests(cleaned_redd,
                          cleaned_car,
                          MR_ests
                          )
```



.center[
&lt;img src="figures/analysis_engine_hex.png" width = 49%/&gt;
  ]

]

.right-plot[
&lt;img src="index_files/figure-html/plot_NOSA_2-1.png" width="504" /&gt;
]


???
Complete for the entire population and all years of record.
Normally, or in the past, our biologists would have to pull
down this data a single year at a time....pivot the spreadsheet,
build equations.....etc.  with no mistakes.

---
class: inverse, bottom, left
background-image: url('figures/dfrm_suite_hex.png')
background-position: top 5% right 5%
background-size: 50%

## Data Visualizaton and Reporting

---

class: inverse, bottom, left
background-image: url('figures/kus_hex.png')
background-position: top 5% right 5%
background-size: 15%

## Data Visualizaton and Reporting

.center[
&lt;a href="http://kus.nptfisheries.org/kus-data/"&gt;
&lt;img src="figures/kus_shiny.png"/&gt;
&lt;/a&gt;
]

---
class: inverse, center, middle

## MentiMeter Poll
### Which part of your research project takes the most time to complete?

  * **Project Administration and Process** (e.g., planning, personnel, metadata documentation)
  * **Budgeting and Contracting** (e.g., inventories, budget tracking, quarterly reports)
  * **Data Management** (e.g., QA/QC, querying, summarizing)
  * **Data Analysis and Hypothesis Testing** (e.g., defining and answering research questions)
  * **Sharing Information and Publishing** (e.g., peer-reviewed, presentations, adaptive management)
  
.center[
  &lt;img src="figures/data_management_wordcloud.png"/&gt;
]
  
---
# In Closing

.pull-left[
* Data Management is a work in progress
* 2020 - 1st year of implementation
  _ Collaborative Project Reports
  - Focused on development
  - Required compromises and concessions
* Currently - 2021
  - Reviewing and documenting methods
  - Identifying missing parts
  - Improving work flow
]

.pull-right[
.center[
  &lt;img src="figures/data.gif"/&gt;
]
]

---
class: inverse, bottom, left
background-image: url('figures/tidy_dfrm_suite.png')
background-position: top 5% right 5%
background-size: 70%

# Credits

.pull-left[
## Website

&lt;a href="http://kus.nptfisheries.org/kus-data"&gt;&lt;img src = "figures/kus_hex.png" width = 15%/&gt;&lt;/a&gt; &lt;/br&gt;
&lt;a href="http://kus.nptfisheries.org/kus-data"&gt;http://kus.nptfisheries.org/kus-data&lt;/a&gt;

## Code

&lt;a href="http://github.com/ryankinzer/cdmsR"&gt;&lt;img src = "figures/cdmsR_hex.png" width = 15%/&gt;&lt;/a&gt;
&lt;a href="http://github.com/ryankinzer/cuyem"&gt;&lt;img src = "figures/dfrm_hex.png" width = 15%/&gt;&lt;/a&gt;
&lt;a href="http://github.com/ryankinzer/fisheR"&gt;&lt;img src = "figures/fisheR_hex.png" width = 15%/&gt;&lt;/a&gt;
&lt;a href="http://github.com/ryankinzer/kus"&gt;&lt;img src = "figures/kus_hex.png" width = 15%/&gt;&lt;/a&gt; &lt;/br&gt;

&lt;a href="http://github.com/ryankinzer/" class="fa fa-github"&gt; &amp;nbsp; http://github.com/ryankinzer/&lt;/a&gt;
]

.pull-right[

&lt;/br&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;/br&gt;

.bottom[
## Cartoons

Timo Elliot
  &lt;a href="http://twitter.com/timoelliott" class="fa fa-twitter"&gt;&lt;/a&gt;
  &lt;a href="https://timoelliott.com" class="fa fa-link"&gt;https://timoelliott.com&lt;/a&gt;
  &lt;br/&gt;
  
Chris Lysy
  &lt;a href="http://twitter.com/clysy" class="fa fa-twitter"&gt;&lt;/a&gt;
  &lt;a href="http://freshspectrum.com" class="fa fa-link"&gt;http://freshspectrum.com&lt;/a&gt;
  &lt;br/&gt;
]
]

???
Chris - yes
Timo - yes
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
